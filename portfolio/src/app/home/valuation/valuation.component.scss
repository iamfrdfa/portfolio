/* ===========================
   valuation.component.scss
   Testimonial-Slider (Viewport/Track/Card/Controls)
   Responsiv, barrierearm, mit Rand-Schleiern.
   Breakpoints: 1200 / 992 / 768 / 560
   =========================== */
@use 'styles/_variables' as *;
@use 'styles/_mixins' as *;

/* SECTION Wrapper */
#valuationComponent {
    padding: clamp(120px, 16vh, 250px) 0;
    overflow-x: clip;
}

/* Hauptcontainer */
.valuation {
    background-color: $secondaryColorBG;
    /* Auf einheitliches Alignment-System umgestellt */
    width: min(var(--container-max), 100% - 2 * var(--gutter));
    margin-inline: auto;
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: clamp(16px, 2.5vw, 24px);
    overflow-x: hidden;
    place-items: center;
}

/* Ãœberschrift */
.sectionTitle {
    @include greenBoxHeadline;
    margin-bottom: 8px;
    font-size: clamp(40px, 7vw, 64px);
}

/* Sichtbereich */
.viewport {
    position: relative;
    /* Auf einheitliches Alignment-System umgestellt */
    width: min(var(--container-max), 100% - 2 * var(--gutter));
    height: clamp(220px, 30vw, 274px);
    overflow: visible;
    margin: 0 auto;
}

/* Track */
.track {
    display: flex;
    will-change: transform;
    transition: transform .65s cubic-bezier(.4,0,.2,1);
    z-index: 1;
}

/* Rand-Schleier */
.viewport::before,
.viewport::after {
    content: "";
    position: absolute;
    top: 0;
    height: 100%;
    width: calc(var(--left-cover, 180px) + 30px); /* +30px breiter */
    pointer-events: none;
    z-index: 4;
}

.viewport::before {
    left: -80px;
    background: linear-gradient(
            to right,
            $secondaryColorBG 0%,
            rgba($secondaryColorBG, .9) 40%,
            rgba($secondaryColorBG, 0) 100%
    );
}

.viewport::after {
    right: -80px;
    background: linear-gradient(
            to left,
            $secondaryColorBG 0%,
            rgba($secondaryColorBG, .9) 40%,
            rgba($secondaryColorBG, 0) 100%
    );
}


/* Karte */
.card {
    flex: 0 0 auto;
    width: clamp(300px, 70vw, 632px);
    height: clamp(220px, 30vw, 274px);
    box-sizing: border-box;
    margin: 0 clamp(14px, 4vw, 36px);
    padding: clamp(16px, 2.5vw, 24px) clamp(18px, 3vw, 32px) clamp(16px, 2.2vw, 22px) clamp(36px, 6vw, 72px);
    background: #173733;
    border: 1px solid $primaryColor;
    border-radius: 20px;
    color: #e8f5f2;

    display: flex;
    flex-direction: column;
    justify-content: space-between;
    position: relative;
    z-index: 1;
}

/* Quote-Icon */
.card .quoteIcon {
    position: absolute;
    top: -32px;
    left: -32px;
    width: clamp(56px, 8vw, 96px);
    height: clamp(56px, 8vw, 96px);
    pointer-events: none;
    z-index: 3;
    opacity: 0;
    transition: opacity .25s ease;
}
.card[aria-hidden="false"] .quoteIcon { opacity: 1; }

/* Typo */
.quote {
    font-size: clamp(16px, 2vw, 20px);
    line-height: 1.35;
}
.signature {
    display: flex;
    align-items: center;
    gap: clamp(10px, 2vw, 16px);
    opacity: .9;
}
.signature .line {
    display: inline-block;
    width: clamp(120px, 30vw, 260px);
    height: 2px;
    background: rgba($primaryColor, .6);
    border-radius: 2px;
}
.author { font-weight: 600; }
.role { opacity: .9; }

/* Fades (derzeit deaktiviert) */
.fade, .fade-left, .fade-right { display: none; }

/* Controls */
.controls {
    display: flex;
    align-items: center;
    gap: clamp(12px, 2.5vw, 18px);

    .arrow {
        position: relative;
        background: transparent;
        border: none;
        padding: 0;
        cursor: pointer;
        width: clamp(36px, 6vw, 40px);
        height: clamp(36px, 6vw, 40px);
        display: inline-flex;
        align-items: center;
        justify-content: center;
        transition: transform .25s ease;

        img { display: none; }

        &::before {
            content: "";
            display: block;
            width: clamp(18px, 3.2vw, 24px);
            height: clamp(18px, 3.2vw, 24px);
            background-color: #fff;
            transition: background-color .25s ease, transform .25s ease;
            -webkit-mask: url('/img/icons/arrow-left.svg') no-repeat center / contain;
            mask: url('/img/icons/arrow-left.svg') no-repeat center / contain;
        }

        &:last-child::before {
            -webkit-mask: url('/img/icons/arrow-right.svg') no-repeat center / contain;
            mask: url('/img/icons/arrow-right.svg') no-repeat center / contain;
        }

        &:hover { transform: scale(1.1); }
        &:active { transform: scale(1.05); }
        &:hover::before { background-color: $primaryColor; }
    }

    .dots { display: flex; gap: clamp(8px, 1.6vw, 10px); }

    .dot {
        display: block;
        width: clamp(7px, 1.6vw, 8px);
        height: clamp(7px, 1.6vw, 8px);
        aspect-ratio: 1;
        border: none;
        border-radius: 50%;
        background: #fff;
        opacity: .35;
        cursor: pointer;
        transition: opacity .2s ease, transform .25s ease, background .25s ease;
    }

    .dot:hover { opacity: .7; background: $primaryColor; transform: scale(1.1); }
    .dot.active { opacity: 1; background: $primaryColor; }
}

/* Motion Prefs */
@media (prefers-reduced-motion: reduce) {
    .track { transition: none !important; }
}

/* <= 770: mehr Sicht auf Nachbar-Slides (kleinerer left-cover sinnvoll im TS) */
@media (max-width: 770px) {
    #valuationComponent { padding: clamp(80px, 12vh, 140px) 0; }

    .viewport {
        margin: 0 0 0 32px !important;
    }

    .sectionTitle {
        font-size: clamp(36px, 4vw, 36px) !important;
    }

    /* Quote-Icon */
    .card .quoteIcon {
        top: -24px !important;
        left: -24px !important;
        width: 48px !important;
        height: 48px !important;
    }
}

/* <= 600: mehr Sicht auf Nachbar-Slides (kleinerer left-cover sinnvoll im TS) */
@media (max-width: 600px) {
    /* Rand-Schleier */
    .viewport::before,
    .viewport::after {
        display: none;
    }
}

/* <= 420 */
@media (max-width: 420px) {
    .card {
        left: 14px !important;
    }

    /* Quote-Icon */
    .card .quoteIcon {
        top: -12px !important;
        left: -12px !important;
        width: 32px !important;
        height: 32px !important;
    }
}

/* <= 370 */
@media (max-width: 370px) {
    .card {
        left: 14px !important;
        width: 250px;
        margin: 0 30px !important;
    }

    /* Quote-Icon */
    .card .quoteIcon {
        top: -12px !important;
        left: -12px !important;
        width: 32px !important;
        height: 32px !important;
    }

    .quote {
        font-size: clamp(14px, 2vw, 20px);
    }
}
